import { TypeList } from "docs-ui"

# WorkflowDefinition

<TypeList types={[{"name":"id","type":"`string`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"handler","type":"(`container`: [MedusaContainer](../../types/workflows.MedusaContainer/page.mdx), `context?`: [Context](../workflows.Context/page.mdx)) => [TransactionStepHandler](../../types/workflows.TransactionStepHandler/page.mdx)","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"orchestrator","type":"[TransactionOrchestrator](../../classes/workflows.TransactionOrchestrator/page.mdx)","description":"TransactionOrchestrator is responsible for managing and executing distributed transactions.\nIt is based on a single transaction definition, which is used to execute all the transaction steps","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"id","type":"`string`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"ROOT_STEP","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"DEFAULT_TTL","type":"`number`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"invokeSteps","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"compensateSteps","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"definition","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"DEFAULT_RETRIES","type":"`number`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"workflowOptions","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"isExpectedError","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"SEPARATOR","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"getPreviousStep","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"getInvokeSteps","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"getCompensationSteps","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"canMoveForward","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"canMoveBackward","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"canContinue","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"hasExpired","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"checkTransactionTimeout","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"checkStepTimeout","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"checkAllSteps","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"computeCurrentTransactionState","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"flagStepsToRevert","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"setStepSuccess","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"skipStep","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"setStepTimeout","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"setStepFailure","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"executeNext","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"finalizeTransaction","type":"`any`","description":"Finalize the transaction when all steps are complete","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"prepareStepForExecution","type":"`any`","description":"Prepare a step for execution by setting state and incrementing attempts","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"createStepPayload","type":"`any`","description":"Create the payload for a step execution","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"prepareHandlerArgs","type":"`any`","description":"Prepare handler arguments for step execution","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"createStepExecutionPromise","type":"`any`","description":"Create the step execution promise with optional tracing","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"executeSyncStep","type":"`any`","description":"Execute a synchronous step and handle its result","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"executeAsyncStep","type":"`any`","description":"Execute an asynchronous step and handle its result","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"handleStepExpiration","type":"`any`","description":"Check if step or transaction has expired and handle timeouts","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"handleStepSuccess","type":"`any`","description":"Handle successful step completion","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"handleStepFailure","type":"`any`","description":"Handle step failure","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"parseFlowOptions","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"createTransactionFlow","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"loadTransactionById","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"buildSteps","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"getStepByAction","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"getTransactionAndStepFromIdempotencyKey","type":"`any`","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"options","type":"`any`","description":"","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"traceTransaction","type":"(`transactionResume`: (...`args`: `any`[]) => Promise&#60;void&#62;, `metadata`: ``{ model_id: string ; transaction_id: string ; flow_metadata: undefined \\| &#123; [key: string]: unknown; eventGroupId?: string ; parentIdempotencyKey?: string ; sourcePath?: string ; preventReleaseEvents?: boolean ; parentStepIdempotencyKey?: string  &#125;  }``) => Promise&#60;any&#62;","description":"Trace workflow transaction for instrumentation","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"traceStep","type":"(`handler`: (...`args`: `any`[]) => Promise&#60;any&#62;, `metadata`: ``{ action: string ; type: \"invoke\" \\| \"compensate\" ; step_id: string ; step_uuid: string ; attempts: number ; failures: number ; async: boolean ; idempotency_key: string  }``) => Promise&#60;any&#62;","description":"Trace workflow steps for instrumentation","optional":true,"defaultValue":"","expandable":false,"children":[]}]},{"name":"flow_","type":"[TransactionStepsDefinition](../../types/workflows.TransactionStepsDefinition/page.mdx)","description":"Defines the structure and behavior of a single step within a transaction workflow.","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"uuid","type":"`string`","description":"A unique identifier for the transaction step.\nThis is set automatically when declaring a workflow with \"createWorkflow\"","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"action","type":"`string`","description":"Specifies the action to be performed in this step.\n\"name\" is an alias for action when creating a workflow with \"createWorkflow\".","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"continueOnPermanentFailure","type":"`boolean`","description":"Indicates whether the workflow should continue even if there is a permanent failure in this step.\nIn case it is set to true, the the current step will be marked as TransactionStepState.PERMANENT\\_FAILURE and the next steps will be executed.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"skipOnPermanentFailure","type":"`boolean` \\| `string`","description":"Indicates whether the workflow should skip all subsequent steps in case of a permanent failure in this step.\nIn case it is set to true, the next steps of the workflow will not be executed and their status will be marked as TransactionStepState.SKIPPED\\_FAILURE.\nIn case it is a string, the next steps until the step name provided will be skipped and the workflow will be resumed from the step provided.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"noCompensation","type":"`boolean`","description":"If true, no compensation action will be triggered for this step in case of a failure.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"maxRetries","type":"`number`","description":"The maximum number of times this step should be retried in case of temporary failures.\nThe default is 0 (no retries).","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"retryInterval","type":"`number`","description":"The interval (in seconds) between retry attempts after a temporary failure.\nThe default is to retry immediately.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"retryIntervalAwaiting","type":"`number`","description":"The interval (in seconds) to retry a step even if its status is \"TransactionStepStatus.WAITING\".","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"timeout","type":"`number`","description":"The maximum amount of time (in seconds) to wait for this step to complete.\nThis is NOT an execution timeout, the step will always be executed and wait for its response.\nIf the response is not received within the timeout set, it will be marked as \"TransactionStepStatus.TIMEOUT\" and the workflow will be reverted as soon as it receives the response.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"async","type":"`boolean`","description":"If true, the step is executed asynchronously. This means that the workflow will not wait for the response of this step.\nAsync steps require to have their responses set using \"setStepSuccess\" or \"setStepFailure\", unless it is combined with \"backgroundExecution: true\".\nIf combined with a timeout, and any response is not set within that interval, the step will be marked as \"TransactionStepStatus.TIMEOUT\" and the workflow will be reverted immediately.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"nested","type":"`boolean`","description":"It flags where the step contains a sub transaction inside itself.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"backgroundExecution","type":"`boolean`","description":"It applies to \"async\" steps only, allowing them to run in the background and automatically complete without external intervention.\nIt is ideal for time-consuming tasks that will be complete after the execution, contrasting with standard \"async\" operations that require a response to be set in a later stage.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"compensateAsync","type":"`boolean`","description":"If true, the compensation function for this step is executed asynchronously. Which means, the response has to be set using \"setStepSuccess\" or \"setStepFailure\".","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"noWait","type":"`boolean`","description":"If true, the workflow will not wait for their sibling steps to complete before moving to the next step.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"saveResponse","type":"`boolean`","description":"If true, the response of this step will be stored.\nDefault is true.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"next","type":"[TransactionStepsDefinition](../../types/workflows.TransactionStepsDefinition/page.mdx) \\| [TransactionStepsDefinition](../../types/workflows.TransactionStepsDefinition/page.mdx)[]","description":"Defines the next step(s) to execute after this step. Can be a single step or an array of steps.","optional":true,"defaultValue":"","expandable":false,"children":[]}]},{"name":"handlers_","type":"Map&#60;string, object&#62;","description":"","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"invoke","type":"[WorkflowStepHandler](../../types/workflows.WorkflowStepHandler/page.mdx)","description":"","optional":false,"defaultValue":"","expandable":false,"children":[]},{"name":"compensate","type":"[WorkflowStepHandler](../../types/workflows.WorkflowStepHandler/page.mdx)","description":"","optional":true,"defaultValue":"","expandable":false,"children":[]}]},{"name":"options","type":"[TransactionModelOptions](../../types/workflows.TransactionModelOptions/page.mdx)","description":"Defines the options for a transaction model, which are applicable to the entire workflow.","optional":false,"defaultValue":"","expandable":false,"children":[{"name":"timeout","type":"`number`","description":"The global timeout for the entire transaction workflow (in seconds).","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"store","type":"`boolean`","description":"If true, the state of the transaction will be persisted.\n\nLearn more in [this documentation](https://docs.medusajs.com/learn/fundamentals/workflows/store-executions).","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"retentionTime","type":"`number`","description":"The number of seconds that the workflow execution should be stored in the database.\n\nLearn more in [this documentation](https://docs.medusajs.com/learn/fundamentals/workflows/store-executions).","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"storeExecution","type":"`boolean`","description":"If true, the execution details of each step will be stored.","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"idempotent","type":"`boolean`","description":"If true, the workflow will use the transaction ID as the key to ensure only-once execution","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"schedule","type":"`string` \\| [SchedulerOptions](../../types/workflows.SchedulerOptions/page.mdx)","description":"Defines the workflow as a scheduled workflow that executes based on the cron configuration passed.\nThe value can either by a cron expression string, or an object that also allows to define the concurrency behavior.","optional":true,"defaultValue":"","expandable":false,"children":[]}]},{"name":"requiredModules","type":"Set&#60;string&#62;","description":"","optional":true,"defaultValue":"","expandable":false,"children":[]},{"name":"optionalModules","type":"Set&#60;string&#62;","description":"","optional":true,"defaultValue":"","expandable":false,"children":[]}]} expandUrl="https://docs.medusajs.com/learn/fundamentals/data-models/manage-relationships#retrieve-records-of-relation" sectionTitle="WorkflowDefinition"/>
